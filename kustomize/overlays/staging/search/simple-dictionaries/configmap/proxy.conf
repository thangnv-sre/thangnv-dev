<VirtualHost *:80>
  ServerName creator.review.pixta.jp
  ServerAlias creator.review.pixtastock.com
  ServerAlias creator-*.review.pixta.jp
  ServerAlias creator-*.review.pixtastock.com
  DocumentRoot /var/www/html

  SetEnvIf Host "^creator-(.*)$" ORIGINAL_DOMAIN=$1
  SetEnvIf Host "^creator\.(.*)$" ORIGINAL_DOMAIN=$1

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On

    RewriteRule ^$ https://%{ENV:ORIGINAL_DOMAIN} [R=301,L]

    RewriteCond %{REQUEST_URI} !^/@
    RewriteCond %{REQUEST_URI} !^/assets/frontend/
    RewriteCond %{REQUEST_URI} !^/cart/
    RewriteCond %{REQUEST_URI} !^/action_logs/
    RewriteCond %{REQUEST_URI} !^/footer_campaigns
    RewriteCond %{REQUEST_URI} !^/lookup-histories
    RewriteRule (.*) https://%{ENV:ORIGINAL_DOMAIN}/$1 [R=301,L]

    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy.conf
  </Directory>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName review.pixta.jp
  ServerAlias *.review.pixta.jp
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]

    # redirect to corporate site
    RewriteRule ^privacy_policy/? https://staging.pixta.co.jp/privacy_policy [R=301,L]
    RewriteRule ^optout/? https://staging.pixta.co.jp/optout [R=301,L]
    RewriteRule ^company/? https://staging.pixta.co.jp/company [R=301,L]
    # redirect to subscriptions api
    RewriteRule ^api$ https://%{HTTP_HOST}/subscriptions/api [R=301,L]
    Redirect 301 /graphic/ /illustration/
    Redirect 301 /mypage_/ /mypage/

    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy.conf
  </Directory>
  <location /channel>
    RequestHeader set Host "channelredirect-staging.pixta.jp"
    ProxyPass https://channelredirect-staging.pixta.jp/channel
    ProxyPassReverse https://channelredirect-staging.pixta.jp/channel
  </location>
  <location /faq>
    RequestHeader set Host "faqredirect-staging.pixta.jp"
    ProxyPass https://faqredirect-staging.pixta.jp/faq
    ProxyPassReverse https://faqredirect-staging.pixta.jp/faq
  </location>
  <location /antenna>
    RequestHeader set Host "antennaredirect-staging.pixta.jp"
    ProxyPass https://antennaredirect-staging.pixta.jp/antenna
    ProxyPassReverse https://antennaredirect-staging.pixta.jp/antenna
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/ja
    ProxyPassReverse http://sitemap-staging.pixta.jp/ja
  </location>
  <location /editor>
    RequestHeader set Host "editor-staging.pixta.jp"
    ProxyPass https://editor-staging.pixta.jp
    ProxyPassReverse https://editor-staging.pixta.jp
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName review.pixtastock.com
  ServerAlias en-*.review.pixtastock.com
  ServerAlias dev-*.review.pixtastock.com
  ServerAlias master.review.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteCond %{HTTP_USER_AGENT} "^Mozilla/5.0 \(Windows NT 6.2; WOW64\) AppleWebKit/537.36 \(KHTML, like Gecko\) Chrome/43.0.2357.81 Safari/537.36" [NC]
    RewriteRule ^.*$ - [F,L]

    RewriteCond %{REQUEST_URI} !^/internal/
    RewriteCond %{HTTP_HOST} ^dev-(.*).review.pixtastock.com$ [OR]
    RewriteCond %{HTTP_HOST} ^master.review.pixtastock.com$
    RewriteRule ^(.*)$ https://en-%{HTTP_HOST}/$1 [R=301,L]
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to corporate site
    RewriteRule ^company/? https://staging.pixta.co.jp/en/company [R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-staging.pixtastock.com"
    ProxyPass https://blogredirect-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/en
    ProxyPassReverse http://sitemap-staging.pixta.jp/en
  </location>
  <location /editor>
    RequestHeader set Host "editor-staging.pixtastock.com"
    ProxyPass https://editor-staging.pixtastock.com
    ProxyPassReverse https://editor-staging.pixtastock.com
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName cn.review.pixtastock.com
  ServerAlias cn-*.review.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-cn-staging.pixtastock.com"
    ProxyPass https://blogredirect-cn-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-cn-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/cn
    ProxyPassReverse http://sitemap-staging.pixta.jp/cn
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName kr.review.pixtastock.com
  ServerAlias kr-*.review.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-kr-staging.pixtastock.com"
    ProxyPass https://blogredirect-kr-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-kr-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/ko
    ProxyPassReverse http://sitemap-staging.pixta.jp/ko
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName th.review.pixtastock.com
  ServerAlias th-*.review.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-th-staging.pixtastock.com"
    ProxyPass https://blogredirect-th-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-th-staging.pixtastock.com/blog
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName tw.review.pixtastock.com
  ServerAlias tw-*.review.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost_review.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/review_reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-tw-staging.pixtastock.com"
    ProxyPass https://blogredirect-tw-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-tw-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/tw
    ProxyPassReverse http://sitemap-staging.pixta.jp/tw
  </location>
  Include /usr/local/apache2/options/location_review.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName creator-staging.pixta.jp
  ServerAlias creator-staging.pixtastock.com
  ServerAlias creator-*-staging.pixta.jp
  ServerAlias creator-*-staging.pixtastock.com
  DocumentRoot /var/www/html

  SetEnvIf Host "^creator-(.*)$" ORIGINAL_DOMAIN=$1
  SetEnvIf Host "^creator-en-(.*)$" ORIGINAL_DOMAIN=staging.pixtastock.com
  SetEnvIf Host "^creator\.(.*)$" ORIGINAL_DOMAIN=$1

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On

    RewriteRule ^$ https://%{ENV:ORIGINAL_DOMAIN} [R=301,L]

    RewriteCond %{REQUEST_URI} !^/@
    RewriteCond %{REQUEST_URI} !^/assets/frontend/
    RewriteRule (.*) https://%{ENV:ORIGINAL_DOMAIN}/$1 [R=301,L]

    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy.conf
  </Directory>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName staging.pixta.jp
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]

    # redirect to corporate site
    RewriteRule ^privacy_policy/? https://staging.pixta.co.jp/privacy_policy [R=301,L]
    RewriteRule ^optout/? https://staging.pixta.co.jp/optout [R=301,L]
    RewriteRule ^company/? https://staging.pixta.co.jp/company [R=301,L]
    # redirect to subscriptions api
    RewriteRule ^api$ https://%{HTTP_HOST}/subscriptions/api [R=301,L]
    Redirect 301 /graphic/ /illustration/
    Redirect 301 /mypage_/ /mypage/

    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy.conf
  </Directory>
  <location /channel>
    RequestHeader set Host "channelredirect-staging.pixta.jp"
    ProxyPass https://channelredirect-staging.pixta.jp/channel
    ProxyPassReverse https://channelredirect-staging.pixta.jp/channel
  </location>
  <location /faq>
    RequestHeader set Host "faqredirect-staging.pixta.jp"
    ProxyPass https://faqredirect-staging.pixta.jp/faq
    ProxyPassReverse https://faqredirect-staging.pixta.jp/faq
  </location>
  <location /antenna>
    RequestHeader set Host "antennaredirect-staging.pixta.jp"
    ProxyPass https://antennaredirect-staging.pixta.jp/antenna
    ProxyPassReverse https://antennaredirect-staging.pixta.jp/antenna
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/ja
    ProxyPassReverse http://sitemap-staging.pixta.jp/ja
  </location>
  <location /editor>
    RequestHeader set Host "editor-staging.pixta.jp"
    ProxyPass https://editor-staging.pixta.jp
    ProxyPassReverse https://editor-staging.pixta.jp
  </location>
  <location /admin/simple_dictionaries>
    RequestHeader set Host "simple-dictionaries-staging.pixta.jp"
    ProxyPass https://simple-dictionaries-staging.pixta.jp/
    ProxyPassReverse https://simple-dictionaries-staging.pixta.jp/
    AddOutputFilterByType SUBSTITUTE text/html
    Substitute "s|staging.pixta.jp/|staging.pixta.jp/admin/simple_dictionaries/|i" 
  </location>
#   <location /admin/simple_dictionaries>
#     RequestHeader set Host "simple-dictionaries-staging.pixta.jp"
#     ProxyPass https://simple-dictionaries-staging.pixta.jp/
#     ProxyPassReverse https://simple-dictionaries-staging.pixta.jp/
#     AddOutputFilterByType SUBSTITUTE text/html
#     Substitute "s|staging.pixta.jp/|simple-dictionaries-staging.pixta.jp/|i" 
#   </location>
#    <location /admin/filter_translations>
#     RequestHeader set Host "simple-dictionaries-staging.pixta.jp"
#     ProxyPass https://simple-dictionaries-staging.pixta.jp/admin/filter_translations/
#     ProxyPassReverse https://simple-dictionaries-staging.pixta.jp/admin/filter_translations/
#   </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName staging.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteCond %{HTTP_USER_AGENT} "^Mozilla/5.0 \(Windows NT 6.2; WOW64\) AppleWebKit/537.36 \(KHTML, like Gecko\) Chrome/43.0.2357.81 Safari/537.36" [NC]
    RewriteRule ^.*$ - [F,L]

    RewriteRule ^@(.*) https://creator-en-staging.pixtastock.com/@$1 [NE,R=301,L]
    # redirect to corporate site
    RewriteRule ^company/? https://staging.pixta.co.jp/en/company [R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-staging.pixtastock.com"
    ProxyPass https://blogredirect-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/en
    ProxyPassReverse http://sitemap-staging.pixta.jp/en
  </location>
  <location /editor>
    RequestHeader set Host "editor-staging.pixtastock.com"
    ProxyPass https://editor-staging.pixtastock.com
    ProxyPassReverse https://editor-staging.pixtastock.com
  </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName cn-staging.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-cn-staging.pixtastock.com"
    ProxyPass https://blogredirect-cn-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-cn-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/cn
    ProxyPassReverse http://sitemap-staging.pixta.jp/cn
  </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName kr-staging.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-kr-staging.pixtastock.com"
    ProxyPass https://blogredirect-kr-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-kr-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/ko
    ProxyPassReverse http://sitemap-staging.pixta.jp/ko
  </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName th-staging.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-th-staging.pixtastock.com"
    ProxyPass https://blogredirect-th-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-th-staging.pixtastock.com/blog
  </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>
<VirtualHost *:80>
  ServerName tw-staging.pixtastock.com
  DocumentRoot /var/www/html

  Include /usr/local/apache2/options/options.conf
  Include /usr/local/apache2/options/virtualhost.conf

  <Directory /var/www/html>
    AllowOverride all
    Options -MultiViews
    Require all granted
    AddOutputFilterByType DEFLATE text/css text/javascript application/x-javascript

    RewriteEngine On
    RewriteRule ^@(.*) https://creator-%{HTTP_HOST}/@$1 [NE,R=301,L]
    # redirect to top
    RewriteRule ^admin/? https://%{HTTP_HOST} [R=301,L]
    # reverse_proxy for microservices
    Include /usr/local/apache2/rewrite_rule/reverse_proxy_oversea.conf
  </Directory>
  <location /blog>
    RequestHeader set Host "blogredirect-tw-staging.pixtastock.com"
    ProxyPass https://blogredirect-tw-staging.pixtastock.com/blog
    ProxyPassReverse https://blogredirect-tw-staging.pixtastock.com/blog
  </location>
  <location /sitemaps>
    RequestHeader set Host "sitemap-staging.pixta.jp"
    ProxyPass http://sitemap-staging.pixta.jp/tw
    ProxyPassReverse http://sitemap-staging.pixta.jp/tw
  </location>
  Include /usr/local/apache2/options/location.conf
</VirtualHost>